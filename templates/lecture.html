{% if lectures|length == 0 %}
    <h5>No active lectures.</h5>
{% endif %}
{% for lecture in lectures %}
    <a href="/lectures/join?lecture_id={{ lecture }}">{{ lecture }}</a><br>
{% endfor %}
<br>
<strong>Join Lecture:</strong>
<form id="join-lecture">
    <input type="text" name="lecture_id" id="lecture_id" placeholder="Enter the lecture code">
    <input type="submit" value="Join">
</form>
<span id="message"></span>

<strong>Create Lecture:</strong>
<form action="/lectures/new" method="post">
    <input type="text" name="lecture_id" id="lecture_id" placeholder="Enter a unique code">
    <input type="submit" value="Create">
</form>

<script>
    $("#join-lecture").submit(function (event) {
        // setup some local variables
        var $form = $(this);
        // let's select and cache all the fields
        var $inputs = $form.find("button");
        // serialize the data in the form
        var serializedData = $form.serialize();

        // let's disable the inputs for the duration of the ajax request
        $inputs.prop("disabled", true);

        $.ajax({
            type: "POST",
            url: "/lectures/join",
            data: serializedData,
            success: function (data) {
                parsed_data = jQuery.parseJSON(data);
                console.log(parsed_data);
                $("#message").text(parsed_data.message);
            }
        })

        {#        // callback handler that will be called on success#}
        {#        request.done(function (response, textStatus, jqXHR) {#}
        {#            // log a message to the console#}
        {#            console.log("Hooray, it worked!");#}
        {#        });#}
        {##}
        {#        // callback handler that will be called on failure#}
        {#        request.fail(function (jqXHR, textStatus, errorThrown) {#}
        {#            // log the error to the console#}
        {#            console.error(#}
        {#                    "The following error occured: " +#}
        {#                            textStatus, errorThrown#}
        {#            );#}
        {#        });#}

        {#            // callback handler that will be called regardless#}
        {#            // if the request failed or succeeded#}
        .always(function () {
            // reenable the inputs
            $inputs.prop("disabled", false);
        });

        // prevent default posting of form
        event.preventDefault();
    });
</script>